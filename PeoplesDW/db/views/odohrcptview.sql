create or replace view ohrcptview
(
BILLOFLADING,
PRIORITY,
WEIGHTCOMMIT,
CUBECOMMIT,
AMTCOMMIT,
QTYSHIP,
WEIGHTSHIP,
CUBESHIP,
AMTSHIP,
QTYTOTCOMMIT,
WEIGHTTOTCOMMIT,
CUBETOTCOMMIT,
AMTTOTCOMMIT,
QTYRCVD,
WEIGHTRCVD,
CUBERCVD,
AMTRCVD,
COMMENT1,
STATUSUSER,
STATUSUPDATE,
LASTUSER,
LASTUPDATE,
ORDERID,
SHIPID,
CUSTID,
ORDERTYPE,
ordertypeabbrev,
ENTRYDATE,
APPTDATE,
SHIPDATE,
PO,
RMA,
ORDERSTATUS,
orderstatusabbrev,
COMMITSTATUS,
FROMFACILITY,
TOFACILITY,
LOADNO,
STOPNO,
SHIPNO,
SHIPTO,
DELAREA,
QTYORDER,
WEIGHTORDER,
CUBEORDER,
AMTORDER,
QTYCOMMIT,
arrivaldate,
consignee,
shiptype,
carrier,
reference,
shipterms,
shiptypeabbrev,
shiptermsabbrev,
priorityabbrev,
hazardous,
stageloc,
QTY2sort,
WEIGHT2sort,
CUBE2sort,
AMT2sort,
QTY2pack,
WEIGHT2pack,
CUBE2pack,
AMT2pack,
QTY2check,
WEIGHT2check,
CUBE2check,
AMT2check,
staffhrs,
wave,
unknownlipcount,
dateshipped,
deliveryservice,
saturdaydelivery,
specialservice1,
specialservice2,
specialservice3,
specialservice4,
cod,
amtcod,
asnvariance,
hdrpassthruchar01,
hdrpassthruchar02,
hdrpassthruchar03,
hdrpassthruchar04,
hdrpassthruchar05,
hdrpassthruchar06,
hdrpassthruchar07,
hdrpassthruchar08,
hdrpassthruchar09,
hdrpassthruchar10,
hdrpassthruchar11,
hdrpassthruchar12,
hdrpassthruchar13,
hdrpassthruchar14,
hdrpassthruchar15,
hdrpassthruchar16,
hdrpassthruchar17,
hdrpassthruchar18,
hdrpassthruchar19,
hdrpassthruchar20,
hdrpassthrunum01,
hdrpassthrunum02,
hdrpassthrunum03,
hdrpassthrunum04,
hdrpassthrunum05,
hdrpassthrunum06,
hdrpassthrunum07,
hdrpassthrunum08,
hdrpassthrunum09,
hdrpassthrunum10,
QTYpick,
WEIGHtpick,
CUBEpick,
AMTpick,
FTZ216Authorization,
qtyrcvdgood,
cubercvdgood,
weightrcvdgood,
qtyrcvddmgd,
cubercvdmgd,
weightrcvddmgd
)
as
select
orderhdr.BILLOFLADING,
orderhdr.PRIORITY,
orderhdr.WEIGHTCOMMIT,
orderhdr.CUBECOMMIT,
orderhdr.AMTCOMMIT,
orderhdr.QTYSHIP,
orderhdr.WEIGHTSHIP,
orderhdr.CUBESHIP,
orderhdr.AMTSHIP,
orderhdr.QTYTOTCOMMIT,
orderhdr.WEIGHTTOTCOMMIT,
orderhdr.CUBETOTCOMMIT,
orderhdr.AMTTOTCOMMIT,
orderhdr.QTYRCVD,
orderhdr.WEIGHTRCVD,
orderhdr.CUBERCVD,
orderhdr.AMTRCVD,
orderhdr.COMMENT1,
orderhdr.STATUSUSER,
orderhdr.STATUSUPDATE,
orderhdr.LASTUSER,
orderhdr.LASTUPDATE,
orderhdr.ORDERID,
orderhdr.SHIPID,
orderhdr.CUSTID,
ORDERTYPE,
ordertypes.abbrev,
orderhdr.ENTRYDATE,
nvl(orderhdr.APPTDATE,loads.apptdate),
SHIPDATE,
orderhdr.PO,
orderhdr.RMA,
orderhdr.ORDERSTATUS,
orderstatus.abbrev,
orderhdr.COMMITSTATUS,
orderhdr.FROMFACILITY,
orderhdr.TOFACILITY,
orderhdr.LOADNO,
orderhdr.STOPNO,
orderhdr.SHIPNO,
orderhdr.SHIPTO,
orderhdr.DELAREA,
orderhdr.QTYORDER,
orderhdr.WEIGHTORDER,
orderhdr.CUBEORDER,
orderhdr.AMTORDER,
orderhdr.QTYCOMMIT,
orderhdr.arrivaldate,
orderhdr.consignee,
orderhdr.shiptype,
nvl(loads.carrier,orderhdr.carrier),
orderhdr.reference,
orderhdr.shipterms,
shipmenttypes.abbrev,
shipmentterms.abbrev,
orderpriority.abbrev,
substr(zci.hazardous_item_on_order(orderhdr.orderid,orderhdr.shipid),1,1),
nvl(orderhdr.stageloc,nvl(loadstop.stageloc,loads.stageloc)),
orderhdr.QTY2sort,
orderhdr.WEIGHT2sort,
orderhdr.CUBE2sort,
orderhdr.AMT2sort,
orderhdr.QTY2pack,
orderhdr.WEIGHT2pack,
orderhdr.CUBE2pack,
orderhdr.AMT2pack,
orderhdr.QTY2check,
orderhdr.WEIGHT2check,
orderhdr.CUBE2check,
orderhdr.AMT2check,
nvl(orderhdr.staffhrs,0),
wave,
zoe.unknown_lip_count(orderhdr.orderid,orderhdr.shipid),
orderhdr.dateshipped,
orderhdr.deliveryservice,
orderhdr.saturdaydelivery,
orderhdr.specialservice1,
orderhdr.specialservice2,
orderhdr.specialservice3,
orderhdr.specialservice4,
orderhdr.cod,
orderhdr.amtcod,
nvl(orderhdr.asnvariance,'N'),
orderhdr.hdrpassthruchar01,
orderhdr.hdrpassthruchar02,
orderhdr.hdrpassthruchar03,
orderhdr.hdrpassthruchar04,
orderhdr.hdrpassthruchar05,
orderhdr.hdrpassthruchar06,
orderhdr.hdrpassthruchar07,
orderhdr.hdrpassthruchar08,
orderhdr.hdrpassthruchar09,
orderhdr.hdrpassthruchar10,
orderhdr.hdrpassthruchar11,
orderhdr.hdrpassthruchar12,
orderhdr.hdrpassthruchar13,
orderhdr.hdrpassthruchar14,
orderhdr.hdrpassthruchar15,
orderhdr.hdrpassthruchar16,
orderhdr.hdrpassthruchar17,
orderhdr.hdrpassthruchar18,
orderhdr.hdrpassthruchar19,
orderhdr.hdrpassthruchar20,
orderhdr.hdrpassthrunum01,
orderhdr.hdrpassthrunum02,
orderhdr.hdrpassthrunum03,
orderhdr.hdrpassthrunum04,
orderhdr.hdrpassthrunum05,
orderhdr.hdrpassthrunum06,
orderhdr.hdrpassthrunum07,
orderhdr.hdrpassthrunum08,
orderhdr.hdrpassthrunum09,
orderhdr.hdrpassthrunum10,
orderhdr.qtypick,
orderhdr.WEIGHTpick,
orderhdr.CUBEpick,
orderhdr.AMTpick,
orderhdr.FTZ216Authorization,
zim14.sum_qtyrcvdgood(orderhdr.orderid,orderhdr.shipid),
zim14.sum_cubercvdgood(orderhdr.orderid,orderhdr.shipid),
zim14.sum_weightrcvdgood(orderhdr.orderid,orderhdr.shipid),
zim14.sum_qtyrcvddmgd(orderhdr.orderid,orderhdr.shipid),
zim14.sum_cubercvddmgd(orderhdr.orderid,orderhdr.shipid),
zim14.sum_weightrcvddmgd(orderhdr.orderid,orderhdr.shipid)
from orderstatus, ordertypes, shipmenttypes, shipmentterms,
     orderpriority, loads, loadstop, orderhdr
where orderhdr.orderstatus = orderstatus.code (+)
  and orderhdr.ordertype = ordertypes.code (+)
  and orderhdr.shiptype = shipmenttypes.code(+)
  and orderhdr.shipterms = shipmentterms.code(+)
  and orderhdr.priority = orderpriority.code(+)
  and orderhdr.loadno = loads.loadno(+)
  and orderhdr.loadno = loadstop.loadno(+)
  and orderhdr.stopno = loadstop.stopno(+)
  and orderhdr.orderstatus = 'R';

comment on table ohrcptview is '$Id$';

create or replace view odrcptview
(
PRIORITY,
ORDERID,
SHIPID,
ITEM,
CUSTID,
FROMFACILITY,
UOM,
LINESTATUS,
COMMITSTATUS,
QTYENTERED,
ITEMENTERED,
UOMENTERED,
QTYORDER,
WEIGHTORDER,
CUBEORDER,
AMTORDER,
QTYCOMMIT,
WEIGHTCOMMIT,
CUBECOMMIT,
AMTCOMMIT,
QTYSHIP,
WEIGHTSHIP,
CUBESHIP,
AMTSHIP,
QTYTOTCOMMIT,
WEIGHTTOTCOMMIT,
CUBETOTCOMMIT,
AMTTOTCOMMIT,
QTYRCVD,
WEIGHTRCVD,
CUBERCVD,
AMTRCVD,
QTYRCVDGOOD,
WEIGHTRCVDGOOD,
CUBERCVDGOOD,
AMTRCVDGOOD,
QTYRCVDDMGD,
WEIGHTRCVDDMGD,
CUBERCVDDMGD,
AMTRCVDDMGD,
COMMENT1,
STATUSUSER,
STATUSUPDATE,
LASTUSER,
LASTUPDATE,
lotnumber,
rcvdvariance,
shipvariance,
qtyreturned,
weightreturned,
cubereturned,
invstatusind,
invstatus,
invclassind,
inventoryclass,
backorder,
QTY2sort,
WEIGHT2sort,
CUBE2sort,
AMT2sort,
QTY2pack,
WEIGHT2pack,
CUBE2pack,
AMT2pack,
QTY2check,
WEIGHT2check,
CUBE2check,
AMT2check,
staffhours,
asnvariance,
QTYpick,
WEIGHTpick,
CUBEpick,
AMTpick,
reference
)
as
select
orderdtl.PRIORITY,
orderdtl.ORDERID,
orderdtl.SHIPID,
orderdtl.ITEM,
orderdtl.CUSTID,
orderdtl.FROMFACILITY,
orderdtl.UOM,
orderdtl.LINESTATUS,
orderdtl.COMMITSTATUS,
orderdtl.QTYENTERED,
orderdtl.ITEMENTERED,
orderdtl.UOMENTERED,
orderdtl.QTYORDER,
orderdtl.WEIGHTORDER,
orderdtl.CUBEORDER,
orderdtl.AMTORDER,
orderdtl.QTYCOMMIT,
orderdtl.WEIGHTCOMMIT,
orderdtl.CUBECOMMIT,
orderdtl.AMTCOMMIT,
orderdtl.QTYSHIP,
orderdtl.WEIGHTSHIP,
orderdtl.CUBESHIP,
orderdtl.AMTSHIP,
orderdtl.QTYTOTCOMMIT,
orderdtl.WEIGHTTOTCOMMIT,
orderdtl.CUBETOTCOMMIT,
orderdtl.AMTTOTCOMMIT,
orderdtl.QTYRCVD,
orderdtl.WEIGHTRCVD,
orderdtl.CUBERCVD,
orderdtl.AMTRCVD,
orderdtl.QTYRCVDGOOD,
orderdtl.WEIGHTRCVDGOOD,
orderdtl.CUBERCVDGOOD,
orderdtl.AMTRCVDGOOD,
orderdtl.QTYRCVDDMGD,
orderdtl.WEIGHTRCVDDMGD,
orderdtl.CUBERCVDDMGD,
orderdtl.AMTRCVDDMGD,
orderdtl.COMMENT1,
orderdtl.STATUSUSER,
orderdtl.STATUSUPDATE,
orderdtl.LASTUSER,
orderdtl.LASTUPDATE,
orderdtl.lotnumber,
nvl(orderdtl.qtyrcvd,0) - nvl(orderdtl.qtyorder,0),
nvl(orderdtl.qtyship,0) - nvl(orderdtl.qtyorder,0),
nvl(orderdtl.qtyrcvd,0) - nvl(orderdtl.qtyrcvdgood,0) - nvl(orderdtl.qtyrcvddmgd,0),
nvl(orderdtl.weightrcvd,0) - nvl(orderdtl.weightrcvdgood,0) - nvl(orderdtl.weightrcvddmgd,0),
nvl(orderdtl.cubercvd,0) - nvl(orderdtl.cubercvdgood,0) - nvl(orderdtl.cubercvddmgd,0),
orderdtl.invstatusind,
orderdtl.invstatus,
orderdtl.invclassind,
orderdtl.inventoryclass,
orderdtl.backorder,
orderdtl.QTY2sort,
orderdtl.WEIGHT2sort,
orderdtl.CUBE2sort,
orderdtl.AMT2sort,
orderdtl.QTY2pack,
orderdtl.WEIGHT2pack,
orderdtl.CUBE2pack,
orderdtl.AMT2pack,
orderdtl.QTY2check,
orderdtl.WEIGHT2check,
orderdtl.CUBE2check,
orderdtl.AMT2check,
nvl(orderdtl.staffhrs,0),
nvl(orderdtl.asnvariance,'N'),
orderdtl.QTYpick,
orderdtl.WEIGHTpick,
orderdtl.CUBEpick,
orderdtl.AMTpick,
orderhdr.reference
from orderhdr, orderdtl
where orderdtl.orderid = orderhdr.orderid(+)
  and orderdtl.shipid = orderhdr.shipid(+)
  and orderhdr.orderstatus = 'R';
  
comment on table odrcptview is '$Id$';
  
-- exit;
