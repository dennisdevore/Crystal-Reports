create or replace view smallpackage
(CARTONID
,ORDERID
,SHIPID
,CUSTID
,SHIPTONAME
,SHIPTOCONTACT
,SHIPTOADDR1
,SHIPTOADDR2
,SHIPTOCITY
,SHIPTOSTATE
,SHIPTOPOSTALCODE
,SHIPTOCOUNTRYCODE
,SHIPTOPHONE
,CARRIER
,CARRIERCODE
,SPECIALSERVICE1
,SPECIALSERVICE2
,SPECIALSERVICE3
,SPECIALSERVICE4
,TERMS
,SATDELIVERY
,ORDERSTATUS
,ORDERPRIORITY
,ORDERCOMMENTS
,REFERENCE
,COD
,AMTCOD
,HDRPASSTHRUCHAR20
,HDRPASSTHRUCHAR19
,SHIPDATE
,PO
,HDRPASSTHRUCHAR01
,HDRPASSTHRUCHAR02
,HDRPASSTHRUCHAR03
,HDRPASSTHRUCHAR04
,HDRPASSTHRUCHAR05
,HDRPASSTHRUCHAR06
,HDRPASSTHRUCHAR07
,HDRPASSTHRUCHAR08
,HDRPASSTHRUCHAR09
,HDRPASSTHRUCHAR10
,HDRPASSTHRUCHAR11
,HDRPASSTHRUCHAR12
,HDRPASSTHRUCHAR13
,HDRPASSTHRUCHAR14
,HDRPASSTHRUCHAR15
,HDRPASSTHRUCHAR16
,HDRPASSTHRUCHAR17
,HDRPASSTHRUCHAR18
,HDRPASSTHRUNUM01
,HDRPASSTHRUNUM02
,HDRPASSTHRUNUM03
,HDRPASSTHRUNUM04
,HDRPASSTHRUNUM05
,HDRPASSTHRUNUM06
,HDRPASSTHRUNUM07
,HDRPASSTHRUNUM08
,HDRPASSTHRUNUM09
,HDRPASSTHRUNUM10
,ESTWEIGHT
,LENGTH
,WIDTH
,HEIGHT
,DTLPASSTHRUCHAR01
,DTLPASSTHRUCHAR02
,DTLPASSTHRUCHAR03
,DTLPASSTHRUCHAR04
,DTLPASSTHRUCHAR05
,DTLPASSTHRUCHAR06
,DTLPASSTHRUCHAR07
,DTLPASSTHRUCHAR08
,DTLPASSTHRUCHAR09
,DTLPASSTHRUCHAR10
,DTLPASSTHRUCHAR11
,DTLPASSTHRUCHAR12
,DTLPASSTHRUCHAR13
,DTLPASSTHRUCHAR14
,DTLPASSTHRUCHAR15
,DTLPASSTHRUCHAR16
,DTLPASSTHRUCHAR17
,DTLPASSTHRUCHAR18
,DTLPASSTHRUCHAR19
,DTLPASSTHRUCHAR20
,DTLPASSTHRUNUM01
,DTLPASSTHRUNUM02
,DTLPASSTHRUNUM03
,DTLPASSTHRUNUM04
,DTLPASSTHRUNUM05
,DTLPASSTHRUNUM06
,DTLPASSTHRUNUM07
,DTLPASSTHRUNUM08
,DTLPASSTHRUNUM09
,DTLPASSTHRUNUM10
,billtoNAME
,billtoCONTACT
,billtoADDR1
,billtoADDR2
,billtoCITY
,billtoSTATE
,billtoPOSTALCODE
,billtoCOUNTRYCODE
,billtoPHONE
,HDRPASSTHRUCHAR21
,HDRPASSTHRUCHAR22
,HDRPASSTHRUCHAR23
,HDRPASSTHRUCHAR24
,HDRPASSTHRUCHAR25
,HDRPASSTHRUCHAR26
,HDRPASSTHRUCHAR27
,HDRPASSTHRUCHAR28
,HDRPASSTHRUCHAR29
,HDRPASSTHRUCHAR30
,HDRPASSTHRUCHAR31
,HDRPASSTHRUCHAR32
,HDRPASSTHRUCHAR33
,HDRPASSTHRUCHAR34
,HDRPASSTHRUCHAR35
,HDRPASSTHRUCHAR36
,HDRPASSTHRUCHAR37
,HDRPASSTHRUCHAR38
,HDRPASSTHRUCHAR39
,HDRPASSTHRUCHAR40
,HDRPASSTHRUCHAR41
,HDRPASSTHRUCHAR42
,HDRPASSTHRUCHAR43
,HDRPASSTHRUCHAR44
,HDRPASSTHRUCHAR45
,HDRPASSTHRUCHAR46
,HDRPASSTHRUCHAR47
,HDRPASSTHRUCHAR48
,HDRPASSTHRUCHAR49
,HDRPASSTHRUCHAR50
,HDRPASSTHRUCHAR51
,HDRPASSTHRUCHAR52
,HDRPASSTHRUCHAR53
,HDRPASSTHRUCHAR54
,HDRPASSTHRUCHAR55
,HDRPASSTHRUCHAR56
,HDRPASSTHRUCHAR57
,HDRPASSTHRUCHAR58
,HDRPASSTHRUCHAR59
,HDRPASSTHRUCHAR60
,HDRPASSTHRUDATE01
,HDRPASSTHRUDATE02
,HDRPASSTHRUDATE03
,HDRPASSTHRUDATE04
,HDRPASSTHRUDOLL01
,HDRPASSTHRUDOLL02
,SSCC
-- ,SHIPPINGPLATETYPE prn 35845 still needs merging
)
as
select
CARTONID
,dtl.ORDERID
,dtl.SHIPID
,hdr.CUSTID
,mhdr.SHIPTONAME
,mhdr.SHIPTOCONTACT
,mhdr.SHIPTOADDR1
,mhdr.SHIPTOADDR2
,mhdr.SHIPTOCITY
,mhdr.SHIPTOSTATE
,mhdr.SHIPTOPOSTALCODE
,mhdr.SHIPTOCOUNTRYCODE
,mhdr.SHIPTOPHONE
,mhdr.CARRIER
,mhdr.CARRIERCODE
,mhdr.SPECIALSERVICE1
,mhdr.SPECIALSERVICE2
,mhdr.SPECIALSERVICE3
,mhdr.SPECIALSERVICE4
,hdr.SHIPTERMS
,nvl(hdr.SATURDAYDELIVERY,'N')
,hdr.ORDERSTATUS
,hdr.PRIORITY
,hdr.COMMENT1
,hdr.REFERENCE
,hdr.COD
,hdr.AMTCOD
,hdr.HDRPASSTHRUCHAR20
,hdr.HDRPASSTHRUCHAR19
,hdr.SHIPDATE
,hdr.PO
,hdr.HDRPASSTHRUCHAR01
,hdr.HDRPASSTHRUCHAR02
,hdr.HDRPASSTHRUCHAR03
,hdr.HDRPASSTHRUCHAR04
,hdr.HDRPASSTHRUCHAR05
,hdr.HDRPASSTHRUCHAR06
,hdr.HDRPASSTHRUCHAR07
,hdr.HDRPASSTHRUCHAR08
,hdr.HDRPASSTHRUCHAR09
,hdr.HDRPASSTHRUCHAR10
,hdr.HDRPASSTHRUCHAR11
,hdr.HDRPASSTHRUCHAR12
,hdr.HDRPASSTHRUCHAR13
,hdr.HDRPASSTHRUCHAR14
,hdr.HDRPASSTHRUCHAR15
,hdr.HDRPASSTHRUCHAR16
,hdr.HDRPASSTHRUCHAR17
,hdr.HDRPASSTHRUCHAR18
,hdr.HDRPASSTHRUNUM01
,hdr.HDRPASSTHRUNUM02
,hdr.HDRPASSTHRUNUM03
,hdr.HDRPASSTHRUNUM04
,hdr.HDRPASSTHRUNUM05
,hdr.HDRPASSTHRUNUM06
,hdr.HDRPASSTHRUNUM07
,hdr.HDRPASSTHRUNUM08
,hdr.HDRPASSTHRUNUM09
,hdr.HDRPASSTHRUNUM10
,round(ESTWEIGHT,4)
,LENGTH
,WIDTH
,HEIGHT
,DTLPASSTHRUCHAR01
,DTLPASSTHRUCHAR02
,DTLPASSTHRUCHAR03
,DTLPASSTHRUCHAR04
,DTLPASSTHRUCHAR05
,DTLPASSTHRUCHAR06
,DTLPASSTHRUCHAR07
,DTLPASSTHRUCHAR08
,DTLPASSTHRUCHAR09
,DTLPASSTHRUCHAR10
,DTLPASSTHRUCHAR11
,DTLPASSTHRUCHAR12
,DTLPASSTHRUCHAR13
,DTLPASSTHRUCHAR14
,DTLPASSTHRUCHAR15
,DTLPASSTHRUCHAR16
,DTLPASSTHRUCHAR17
,DTLPASSTHRUCHAR18
,DTLPASSTHRUCHAR19
,DTLPASSTHRUCHAR20
,DTLPASSTHRUNUM01
,DTLPASSTHRUNUM02
,DTLPASSTHRUNUM03
,DTLPASSTHRUNUM04
,DTLPASSTHRUNUM05
,DTLPASSTHRUNUM06
,DTLPASSTHRUNUM07
,DTLPASSTHRUNUM08
,DTLPASSTHRUNUM09
,DTLPASSTHRUNUM10
,nvl(hdr.billtoNAME,bt.name)
,nvl(hdr.billtoCONTACT,bt.contact)
,nvl(hdr.billtoADDR1,bt.addr1)
,nvl(hdr.billtoADDR2,bt.addr2)
,nvl(hdr.billtoCITY,bt.city)
,nvl(hdr.billtoSTATE,bt.state)
,nvl(hdr.billtoPOSTALCODE,bt.postalcode)
,nvl(hdr.billtoCOUNTRYCODE,bt.countrycode)
,nvl(hdr.billtoPHONE,bt.phone)
,hdr.HDRPASSTHRUCHAR21
,hdr.HDRPASSTHRUCHAR22
,hdr.HDRPASSTHRUCHAR23
,hdr.HDRPASSTHRUCHAR24
,hdr.HDRPASSTHRUCHAR25
,hdr.HDRPASSTHRUCHAR26
,hdr.HDRPASSTHRUCHAR27
,hdr.HDRPASSTHRUCHAR28
,hdr.HDRPASSTHRUCHAR29
,hdr.HDRPASSTHRUCHAR30
,hdr.HDRPASSTHRUCHAR31
,hdr.HDRPASSTHRUCHAR32
,hdr.HDRPASSTHRUCHAR33
,hdr.HDRPASSTHRUCHAR34
,hdr.HDRPASSTHRUCHAR35
,hdr.HDRPASSTHRUCHAR36
,hdr.HDRPASSTHRUCHAR37
,hdr.HDRPASSTHRUCHAR38
,hdr.HDRPASSTHRUCHAR39
,hdr.HDRPASSTHRUCHAR40
,hdr.HDRPASSTHRUCHAR41
,hdr.HDRPASSTHRUCHAR42
,hdr.HDRPASSTHRUCHAR43
,hdr.HDRPASSTHRUCHAR44
,hdr.HDRPASSTHRUCHAR45
,hdr.HDRPASSTHRUCHAR46
,hdr.HDRPASSTHRUCHAR47
,hdr.HDRPASSTHRUCHAR48
,hdr.HDRPASSTHRUCHAR49
,hdr.HDRPASSTHRUCHAR50
,hdr.HDRPASSTHRUCHAR51
,hdr.HDRPASSTHRUCHAR52
,hdr.HDRPASSTHRUCHAR53
,hdr.HDRPASSTHRUCHAR54
,hdr.HDRPASSTHRUCHAR55
,hdr.HDRPASSTHRUCHAR56
,hdr.HDRPASSTHRUCHAR57
,hdr.HDRPASSTHRUCHAR58
,hdr.HDRPASSTHRUCHAR59
,hdr.HDRPASSTHRUCHAR60
,hdr.HDRPASSTHRUDATE01
,hdr.HDRPASSTHRUDATE02
,hdr.HDRPASSTHRUDATE03
,hdr.HDRPASSTHRUDATE04
,hdr.HDRPASSTHRUDOLL01
,hdr.HDRPASSTHRUDOLL02
,dtl.SSCC
-- ,dtl.SHIPPINGPLATETYPE prn 35845 still needs merging
from consignee bt, orderhdr hdr, multishiphdr mhdr, multishipdtl dtl
where dtl.orderid = hdr.orderid
  and dtl.shipid = hdr.shipid
  and dtl.orderid = mhdr.orderid
  and dtl.shipid = mhdr.shipid
  and hdr.priority != 'E'
  and hdr.consignee = bt.consignee(+);
  
comment on table smallpackage is '$Id$';
  
--exit;
