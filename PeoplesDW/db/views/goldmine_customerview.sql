create or replace view goldmine_customerview
(
lastupdate,
custid,                       
name,                         
lookup,                       
contact,                      
addr1,                        
addr2,                        
city,                         
state,                        
postalcode,                   
countrycode,                  
phone,                        
fax,                          
email,                        
rnewname,                     
rnewcontact,                  
rnewaddr1,                    
rnewaddr2,                    
rnewcity,                     
rnewstate,                    
rnewpostalcode,               
rnewcountrycode,              
rnewphone,                    
rnewfax,                      
rnewemail,                    
rnewbilltype,                 
rnewbillfreq,                 
rnewbillday,                  
rnewautobill,                 
rcptname,                     
rcptcontact,                  
rcptaddr1,                    
rcptaddr2,                    
rcptcity,                     
rcptstate,                    
rcptpostalcode,               
rcptcountrycode,              
rcptphone,                    
rcptfax,                      
rcptemail,                    
rcptbilltype,                 
rcptbillfreq,                 
rcptbillday,                  
rcptautobill,                 
miscname,                     
misccontact,                  
miscaddr1,                    
miscaddr2,                    
misccity,                     
miscstate,                    
miscpostalcode,               
misccountrycode,              
miscphone,                    
miscfax,                      
miscemail,                    
miscbilltype,                 
miscbillfreq,                 
miscbillday,                  
miscautobill,                 
outbname,                     
outbcontact,                  
outbaddr1,                    
outbaddr2,                    
outbcity,                     
outbstate,                    
outbpostalcode,               
outbcountrycode,              
outbphone,                    
outbfax,                      
outbemail,                    
outbbilltype,                 
outbbillfreq,                 
outbbillday,                  
outbautobill,                 
status,                       
poverify,                     
splitrecvstorage,             
credithold,                   
sqft,                         
lotrequired,                  
lotrftag,                     
serialrequired,               
serialrftag,                  
user1required,                
user1rftag,                   
user2required,                
user2rftag,                   
user3required,                
user3rftag,              
mfgdaterequired,              
expdaterequired,              
nodamaged,                    
countryrequired,              
powhenverify,                 
pomapfile,                    
porptfile,                    
poverifyemail,                
poverifyfax,                  
poverifyonline,               
poverifybatch,                
pomaponline,                  
poemailfile,
pofaxfile,
powhenfax,                    
powhenemail,                  
powhenbatch,                  
powhenonline,
statusabbrev,
lbs_to_kgs_conversion_factor,
lbs_to_kgs_round_up_down_none,
default_weight_uom,
rcptrptemail,
rnewrptemail,
outbrptemail,
miscrptemail,
lastuser
)
as
select
greatest(nvl(customer.lastupdate, to_date('01-JAN-1900','DD-MON-YYYY')) ,
         nvl(customer_aux.lastupdate, to_date('01-JAN-1900','DD-MON-YYYY'))) lastupdate,
customer.custid as custid,                       
name,                         
lookup,                       
contact,                      
addr1,
addr2,                        
city,                         
state,                        
postalcode,                   
countrycode,                  
phone,                        
fax,                          
email,                        
rnewname,                     
rnewcontact,                  
rnewaddr1,                    
rnewaddr2,                    
rnewcity,                     
rnewstate,                    
rnewpostalcode,               
rnewcountrycode,              
rnewphone,                    
rnewfax,                      
rnewemail,                    
rnewbilltype,                 
rnewbillfreq,                 
rnewbillday,                  
rnewautobill,                 
rcptname,                     
rcptcontact,                  
rcptaddr1,                    
rcptaddr2,                    
rcptcity,                     
rcptstate,                    
rcptpostalcode,               
rcptcountrycode,              
rcptphone,                    
rcptfax,                      
rcptemail,                    
rcptbilltype,                 
rcptbillfreq,
rcptbillday,                  
rcptautobill,                 
miscname,                     
misccontact,                  
miscaddr1,                    
miscaddr2,                    
misccity,                     
miscstate,                    
miscpostalcode,               
misccountrycode,              
miscphone,                    
miscfax,                      
miscemail,                    
miscbilltype,                 
miscbillfreq,                 
miscbillday,                  
miscautobill,                 
outbname,                     
outbcontact,                  
outbaddr1,                    
outbaddr2,                    
outbcity,                     
outbstate,                    
outbpostalcode,               
outbcountrycode,              
outbphone,                    
outbfax,                      
outbemail,                    
outbbilltype,                 
outbbillfreq,                 
outbbillday,                  
outbautobill,                 
status,                       
poverify,                     
splitrecvstorage,             
credithold,
sqft,                         
lotrequired,                  
lotrftag,                     
serialrequired,               
serialrftag,                  
user1required,                
user1rftag,                   
user2required,                
user2rftag,                   
user3required,                
user3rftag,                
mfgdaterequired,              
expdaterequired,              
nodamaged,                    
countryrequired,              
powhenverify,                 
pomapfile,                    
porptfile,                    
poverifyemail,                
poverifyfax,                  
poverifyonline,               
poverifybatch,                
pomaponline,                  
poemailfile,                  
pofaxfile,                    
powhenfax,                    
powhenemail,                  
powhenbatch,                  
powhenonline ,
customerstatus.abbrev,
decode(nvl(lbs_to_kgs_conversion_factor,0),0,zwt.system_lbs_to_kgs_factor,lbs_to_kgs_conversion_factor),
decode(nvl(lbs_to_kgs_round_up_down_none,'s'),'s',nvl(substr(zci.default_value('weight_rounding'),1,1),'n'),
  lbs_to_kgs_round_up_down_none),
nvl(default_weight_uom,'lb'),
rcptrptemail,
rnewrptemail,
outbrptemail,
miscrptemail,
customer.lastuser
from customer, customerstatus, customer_aux
where customer.status = customerstatus.code (+)
and customer.custid = customer_aux.custid;

comment on table goldmine_customerview is '$id: goldmine_customerview.sql 1416 2006-12-19 23:11:38z ed $';

exit;
